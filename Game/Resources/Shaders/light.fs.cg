#include "structs.cg"

float4 main( VertexToFragment IN,
			 uniform sampler2D decal : TEX0 ) : COLOR
{
	float4 texdiffuse = tex2D(decal, IN.uv);
	IN.normal = normalize( IN.normal );

	float ndotl = max( 0.0, dot( IN.normal, IN.lights[0].direction ) );

	float4 diffuse = texdiffuse * IN.lights[0].color;
	float4 color = ndotl * diffuse;

	return float4( color.xyz, 1.0 );
}